# =============================================================================
# Forge Infrastructure Configuration
# =============================================================================
# Copy to .env and fill in values (never commit .env)
#
# Quick start:
#   cp .env.example .env
#   # Edit .env with secure passwords
#   docker compose up -d
#
# Required databases (create before first run):
#   docker exec -it uc-postgres psql -U uc_admin -c "CREATE DATABASE metastore;"
#   docker exec -it uc-postgres psql -U uc_admin -c "CREATE DATABASE mlflow;"
#   docker exec -it uc-postgres psql -U uc_admin -c "CREATE DATABASE marquez;"
#
# Required buckets (create after MinIO starts):
#   mc alias set forge http://localhost:9000 $MINIO_ROOT_USER $MINIO_ROOT_PASSWORD
#   mc mb forge/forge
# =============================================================================

# -----------------------------------------------------------------------------
# PostgreSQL - Shared metadata store
# -----------------------------------------------------------------------------
# Used by: Unity Catalog, Hive Metastore, MLflow
# Each service uses a separate database (unity_catalog, metastore, mlflow)
UC_DB_PASSWORD=CHANGE_ME_TO_SECURE_PASSWORD

# -----------------------------------------------------------------------------
# MinIO - S3-compatible object storage
# -----------------------------------------------------------------------------
# Stores: Delta Lake tables, MLflow artifacts
# Bucket structure:
#   s3://forge/lake/bronze/...   <- Delta tables
#   s3://forge/lake/silver/...
#   s3://forge/lake/gold/...
#   s3://forge/mlflow/...        <- Model artifacts
MINIO_ROOT_USER=minio
MINIO_ROOT_PASSWORD=CHANGE_ME_TO_SECURE_PASSWORD

# MinIO data path - MUST be local disk, NOT NFS-mounted
# MinIO-on-NFS has weird locking behavior and failure modes.
# For NAS deployment: /volume1/forge-data (local SSD/HDD on NAS)
# For dev/WSL: ./minio-data (default if not set)
# MINIO_DATA_PATH=./minio-data

# -----------------------------------------------------------------------------
# Unity Catalog - Delta Lake storage path
# -----------------------------------------------------------------------------
# Mounted in container as /lake for UC file access
# Note: Primary writes go through MinIO (s3a://), this is for UC metadata
LAKE_PATH=/path/to/your/lake

# -----------------------------------------------------------------------------
# Client-side configuration (for koe-tts and other projects)
# -----------------------------------------------------------------------------
# These are NOT used by docker-compose, but document what clients should set.
# Add to your project's .envrc or source via `koe bootstrap`:
#
# # Service endpoints
# export METASTORE_URI="thrift://localhost:9083"
# export MINIO_ENDPOINT="http://localhost:9000"
# export MLFLOW_TRACKING_URI="http://localhost:5002"
# export VAULT_ADDR="http://localhost:8200"
#
# # Lake roots (different URI schemes for different engines)
# export FORGE_LAKE_ROOT_S3A="s3a://forge/lake"  # Spark (hadoop-aws)
# export FORGE_LAKE_ROOT_S3="s3://forge/lake"    # DuckDB (httpfs)
#
# # Lineage
# export OPENLINEAGE_URL="http://localhost:5000"
